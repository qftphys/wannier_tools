
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.3. Capabilities of WannierTools &#8212; WannierTools 2.2.6 documentation</title>
    <link rel="stylesheet" href="static/classic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Tutorial: learning WannierTools through examples" href="tutorials.html" />
    <link rel="prev" title="1.2. Introduction of input files" href="input.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorials.html" title="2. Tutorial: learning WannierTools through examples"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="input.html" title="1.2. Introduction of input files"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">WannierTools 2.2.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="preliminaries.html" accesskey="U">1. Preliminaries</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="capabilities-of-wanniertools">
<h1>1.3. Capabilities of WannierTools<a class="headerlink" href="#capabilities-of-wanniertools" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="#bulkbandcalculation"><span class="std std-ref">Bulk band calculation (line mode and plane mode)</span></a></li>
<li><a class="reference internal" href="#bulkfscalculation"><span class="std std-ref">BulkFS calculation</span></a></li>
<li><a class="reference internal" href="#doscalculation"><span class="std std-ref">Density state(DOS) calculations</span></a></li>
<li><a class="reference internal" href="#findnodescalculation"><span class="std std-ref">Find Nodes calculation</span></a></li>
<li><a class="reference internal" href="#energygapcalculation"><span class="std std-ref">Energy gap calculations (plane and cube mode)</span></a></li>
<li><a class="reference internal" href="#slabbandcalculation"><span class="std std-ref">Slab band calculation</span></a></li>
<li><a class="reference internal" href="#ribbonbandcalculation"><span class="std std-ref">Nanowire/nanoribbon  band calculation</span></a></li>
<li><a class="reference internal" href="#sscalculation"><span class="std std-ref">Surface state ARPES calculation</span></a></li>
<li><a class="reference internal" href="#ssqpicalculation"><span class="std std-ref">Surface state QPI calculation</span></a></li>
<li><a class="reference internal" href="#fermiarccalculation"><span class="std std-ref">Fermi arc calculation</span></a></li>
<li><a class="reference internal" href="#spintexturecalculation"><span class="std std-ref">Spin texture calculation</span></a></li>
<li><a class="reference internal" href="#berryphasecalculation"><span class="std std-ref">Berry phase calculation</span></a></li>
<li><a class="reference internal" href="#berrycurvcalculation"><span class="std std-ref">Berry curvature calculation</span></a></li>
<li><a class="reference internal" href="#wanniercentercalculation"><span class="std std-ref">Wannier charge center/Wilson loop calculation</span></a></li>
<li><a class="reference internal" href="#z2bulkcalculation"><span class="std std-ref">Z2 number for 3D bulk materials</span></a></li>
<li><a class="reference internal" href="#chernbulkcalculation"><span class="std std-ref">Chern number for 3D bulk materials</span></a></li>
<li><a class="reference internal" href="#weylchiralitycalculation"><span class="std std-ref">Weyl Chirality calculation</span></a></li>
<li><a class="reference internal" href="#landaulevel"><span class="std std-ref">Landau level calculations</span></a></li>
</ul>
<div class="section" id="bulk-band-calculation-line-mode-and-plane-mode">
<span id="bulkbandcalculation"></span><h2>1.3.1. Bulk band calculation (line mode and plane mode)<a class="headerlink" href="#bulk-band-calculation-line-mode-and-plane-mode" title="Permalink to this headline">¶</a></h2>
<div class="section" id="line-mode">
<h3>Line mode<a class="headerlink" href="#line-mode" title="Permalink to this headline">¶</a></h3>
<p>Calculate bulk energy band for a series k lines. This is the basic calculation after the
construction of Wannier functions. You have to compare your Wannier interpolated bands
with the DFT bands. Those two bands should match well around the Fermi level.</p>
<div class="section" id="input">
<span id="bulkekin"></span><h4>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h4>
<p>Typical flags for bulk band calculation in the wt.in.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BulkBand_calc = T
/
&amp;PARAMETERS
Nk1 = 101   ! Number of k points for each k line
/

KPATH_BULK     ! k point path
4              ! number of k lines only for bulk band
G 0.00000 0.00000 0.0000 Z 0.00000 0.00000 0.5000
Z 0.00000 0.00000 0.5000 F 0.50000 0.50000 0.0000
F 0.50000 0.50000 0.0000 G 0.00000 0.00000 0.0000
G 0.00000 0.00000 0.0000 L 0.50000 0.00000 0.0000
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a>, <a class="reference internal" href="input.html#kpathbulk"><span class="std std-ref">KPATH_BULK</span></a></p>
</div>
<div class="section" id="output">
<span id="bulkekout"></span><h4>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h4>
<p>The outputs for bulk band calculation are <strong>bulkek.dat</strong> and <strong>bulkek.gnu</strong>. You can get the band plot by running</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">bulkek</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xmgrace</span> <span class="n">bulkek</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
<p>to get bandstucture plot.</p>
<p>The data structure for <strong>bulkek.dat</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">0.000000000</span>       <span class="o">-</span><span class="mf">2.673821992</span>  <span class="mi">119</span>   <span class="mi">80</span>   <span class="mi">80</span>  <span class="mi">119</span>   <span class="mi">80</span>   <span class="mi">80</span>  <span class="mi">205</span>  <span class="mi">138</span>  <span class="mi">138</span>   <span class="mi">70</span>   <span class="mi">40</span>   <span class="mi">40</span>   <span class="mi">70</span>   <span class="mi">40</span>   <span class="mi">40</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
<span class="mf">0.016453872</span>       <span class="o">-</span><span class="mf">2.681536808</span>  <span class="mi">118</span>   <span class="mi">78</span>   <span class="mi">78</span>  <span class="mi">118</span>   <span class="mi">78</span>   <span class="mi">78</span>  <span class="mi">203</span>  <span class="mi">134</span>  <span class="mi">134</span>   <span class="mi">82</span>   <span class="mi">41</span>   <span class="mi">41</span>   <span class="mi">82</span>   <span class="mi">41</span>   <span class="mi">41</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>    <span class="mi">0</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>The 1st column represents k points for the given kpath (KPATH_BULK)</li>
<li>The 2nd column is the energy level</li>
<li>From the 3rd to the n’th column are the projected weight of the wave
function at each k point and each band onto
each wannier orbitals. Those weights are normalized
to 255 for the color plot convinence.</li>
</ol>
<p>The subrotine for this feature is <a href="#id1"><span class="problematic" id="id2">:f:func:`ek_bulk`</span></a></p>
</div>
</div>
<div class="section" id="plane-mode">
<h3>Plane mode<a class="headerlink" href="#plane-mode" title="Permalink to this headline">¶</a></h3>
<p>Calculate band structure in a k slice(plane) specified by KPLANE_BULK card.
The mode is very useful to visualize the Dirac/Weyl cone. You have to set the following tags in <strong>wt.in</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BulkBand_plane_calc = T
/
&amp;PARAMETERS
Nk1 = 51   ! Number of k points along the first vector in KPLANE_BULK
Nk2 = 51   ! Number of k points along the second vector in KPLANE_BULK
/

KPLANE_BULK   ! fractional coordinates
 0.00  0.00  0.30   ! Middle point for a k slice(plane) in 3D BZ. Usually, the position of Dirac points.
 0.50  0.00  0.00   ! The first vector to define k plane(slice) in 3D BZ
 0.00  0.50  0.00   ! The second vector to define k plane(slice) in 3D BZ
</pre></div>
</div>
<p>The output file is <strong>bulkek_plane.dat</strong>, <strong>bulkek_plane-matlab.dat</strong> and <strong>bulkek_plane.gnu</strong>. You can get
<strong>bulkek_plane.png</strong> with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">bulkek_plane</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p>The <strong>bulkek_plane-matlab.dat</strong> is in MATLAB data format. You can plot the Dirac cone with matlab.</p>
<p>The format of <strong>bulkek_plane.dat</strong> is as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>        <span class="c1"># kx                 ky                 kz                 k1                 k2                 k3   E(Numoccupied-1)     E(Numoccupied)   E(Numoccupied+1)   E(Numoccupied+2)</span>
<span class="o">-</span><span class="mf">0.299354337</span>       <span class="o">-</span><span class="mf">0.518496963</span>        <span class="mf">0.180167841</span>       <span class="o">-</span><span class="mf">0.518496936</span>       <span class="o">-</span><span class="mf">0.299354384</span>        <span class="mf">0.180167841</span>       <span class="o">-</span><span class="mf">1.311721381</span>       <span class="o">-</span><span class="mf">1.311705191</span>        <span class="mf">0.588683811</span>        <span class="mf">0.588872215</span>
<span class="o">-</span><span class="mf">0.299354337</span>       <span class="o">-</span><span class="mf">0.504670376</span>        <span class="mf">0.180167841</span>       <span class="o">-</span><span class="mf">0.511583643</span>       <span class="o">-</span><span class="mf">0.287380208</span>        <span class="mf">0.180167841</span>       <span class="o">-</span><span class="mf">1.294078082</span>       <span class="o">-</span><span class="mf">1.293904952</span>        <span class="mf">0.586780093</span>        <span class="mf">0.587249790</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Column 1-3rd are k points in cartesian coordinates. Column 4-6th are k points in a rotated cartesian coordinates
where the x and y direction are line in the k plane and the z direction is perpendicular to the k plane you specified.
Column 7-10th are energies at each k point. Here we only print out 4 energy bands around the fermilevel. It depends on <strong>NumOccupied</strong>.
Usually, I choose column 4th and 5th as k coordinates and choose 8 and 9 as energy bands to show the Dirac cone shown below.</p>
<a class="reference internal image-reference" href="images/bulkek_plane.png"><img alt="images/bulkek_plane.png" src="images/bulkek_plane.png" style="width: 288.0px; height: 252.0px;" /></a>
</div>
</div>
<div class="section" id="bulkfs-calculation">
<span id="bulkfscalculation"></span><h2>1.3.2. BulkFS calculation<a class="headerlink" href="#bulkfs-calculation" title="Permalink to this headline">¶</a></h2>
<p>Bulk Fermi surface calculation.</p>
<div class="section" id="id3">
<h3>Input<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>You should specify the number of k points for each three reciprocal vectors Nk1, Nk2, Nk3
in NAMELISTS PARAMETERS</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BulkFS_calc = T
/
&amp;PARAMETERS
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
Nk2 = 101   ! No. of slices for the 2nd reciprocal vector
Nk3 = 101   ! No. of slices for the 3rd reciprocal vector
/

KCUBE_BULK
  0.00  0.00  0.00   ! Original point for 3D k plane
  1.00  0.00  0.00   ! The first vector to define 3d k space plane
  0.00  1.00  0.00   ! The second vector to define 3d k space plane
  0.00  0.00  1.00   ! The third vector to define 3d k cube
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a></p>
</div>
<div class="section" id="id4">
<h3>Output<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The outputs for this function are <strong>FS3D.bxsf</strong>.
You can plot the FS with <a class="reference external" href="http://www.xcrysden.org">xcrysden</a>  run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>xcrysden —bxsf FS3D.bxsf
</pre></div>
</div>
<p>to get the plot.</p>
<p>By the way, Bulk band and BulkFS calculations were already implemented in Wannier90 code.</p>
</div>
</div>
<div class="section" id="density-state-dos-calculations">
<span id="doscalculation"></span><h2>1.3.3. Density state(DOS) calculations<a class="headerlink" href="#density-state-dos-calculations" title="Permalink to this headline">¶</a></h2>
<p>Calculation density of state for the bulk system. The typical setup in <strong>wt.in</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
DOS_calc = T
/
&amp;PARAMETERS
OmegaNum = 601    ! number of slices of energy
OmegaMin = -1.0   ! erergy range for DOS
OmegaMax =  1.0
Nk1 = 51   ! No. of slices for the 1st reciprocal vector
Nk2 = 51   ! No. of slices for the 2nd reciprocal vector
Nk3 = 51   ! No. of slices for the 3nd reciprocal vector
/

KCUBE_BULK
  0.00  0.00  0.00   ! Original point for 3D k plane
  1.00  0.00  0.00   ! The first vector to define 3d k space plane
  0.00  1.00  0.00   ! The second vector to define 3d k space plane
  0.00  0.00  1.00   ! The third vector to define 3d k cube
</pre></div>
</div>
<p>Outputs are <strong>dos.dat</strong> and <strong>dos.gnu</strong>. <strong>dos.eps</strong> will be obtained with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">dos</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
</div>
<div class="section" id="energy-gap-calculations-plane-and-cube-mode">
<span id="energygapcalculation"></span><h2>1.3.4. Energy gap calculations (plane and cube mode)<a class="headerlink" href="#energy-gap-calculations-plane-and-cube-mode" title="Permalink to this headline">¶</a></h2>
<p>We support two modes for energy gap calculations.The formula is
<span class="math">\(gap(k)= E_{NumOccupied+1}(k)- E_{NumOccpuied}(k)\)</span></p>
<div class="section" id="gap-plane-mode">
<h3>Gap_plane mode<a class="headerlink" href="#gap-plane-mode" title="Permalink to this headline">¶</a></h3>
<p>Calculate the energy gap for the k points in the KPLANE_BULK.
This is useful to show Weyl points and nodal line structure.</p>
<div class="section" id="id5">
<h4>Input<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Typical input parameters for BulkGap_plane calculation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BulkGap_Plane_calc = T
/
&amp;PARAMETERS
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
Nk2 = 101   ! No. of slices for the 2nd reciprocal vector
/

KPLANE_BULK
 0.00  0.00  0.00   ! Original point for 3D k plane
 1.00  0.00  0.00   ! The first vector to define 3d k space plane(slice)
 0.00  0.50  0.00   ! The second vector to define 3d k space plane(slice)
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a>, <a class="reference internal" href="input.html#kpathbulk"><span class="std std-ref">KPATH_BULK</span></a></p>
</div>
<div class="section" id="id6">
<h4>Output<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The outputs for Gap_plane mode are <strong>GapPlane.dat</strong>, <strong>GapPlane.gnu</strong>. The <strong>GapPlane.png</strong> will get by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">GapPlane</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p>The head of <strong>GapPlane.dat</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">kx</span>              <span class="n">ky</span>              <span class="n">kz</span>             <span class="n">gap</span>             <span class="n">Ev4</span>             <span class="n">Ev3</span>             <span class="n">Ev2</span>             <span class="n">Ev1</span>             <span class="n">Ec1</span>             <span class="n">Ec2</span>             <span class="n">Ec3</span>             <span class="n">Ec4</span>              <span class="n">k1</span>              <span class="n">k2</span>              <span class="n">k3</span>
<span class="mf">0.00000000</span>      <span class="mf">0.00000000</span>      <span class="mf">0.00000000</span>      <span class="mf">0.45569845</span>     <span class="o">-</span><span class="mf">0.69109275</span>     <span class="o">-</span><span class="mf">0.69109055</span>     <span class="o">-</span><span class="mf">0.29654328</span>     <span class="o">-</span><span class="mf">0.29654073</span>      <span class="mf">0.15915772</span>      <span class="mf">0.15915871</span>      <span class="mf">1.24348171</span>      <span class="mf">1.24348457</span>      <span class="mf">0.00000000</span>      <span class="mf">0.00000000</span>      <span class="mf">0.00000000</span>
<span class="mf">0.03796028</span>     <span class="o">-</span><span class="mf">0.02191637</span>      <span class="mf">0.00548462</span>      <span class="mf">0.43770730</span>     <span class="o">-</span><span class="mf">0.77636510</span>     <span class="o">-</span><span class="mf">0.77598312</span>     <span class="o">-</span><span class="mf">0.26035113</span>     <span class="o">-</span><span class="mf">0.26027881</span>      <span class="mf">0.17742849</span>      <span class="mf">0.17771545</span>      <span class="mf">1.29499437</span>      <span class="mf">1.29505298</span>      <span class="mf">0.00000000</span>      <span class="mf">0.02500000</span>      <span class="mf">0.00000000</span>
</pre></div>
</div>
<ul class="simple">
<li>Column 1-3 are the Cartesian coordinates of the k points in the KPLANE_BULK, in unit of <span class="math">\(\frac{1}{Angstrom}\)</span></li>
<li>Column 4 is the energy gap</li>
<li>Column 5-12 are the energy value for valence and conduction bands close to the Fermi level. There are
4 conduction bands and 4 valence bands.</li>
<li>Column 13-15 are the Direct coordinates of the k points in the KPLANE_BULK</li>
</ul>
</div>
</div>
<div class="section" id="gap-cube-mode">
<h3>Gap_Cube mode<a class="headerlink" href="#gap-cube-mode" title="Permalink to this headline">¶</a></h3>
<p>This helps us to find Weyl points and nodal line structure in the 3D BZ.</p>
<p>Typical input parameters for BulkGap_cube calculation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BulkGap_Cube_calc = T
/
&amp;PARAMETERS
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
Nk2 = 101   ! No. of slices for the 2nd reciprocal vector
Nk3 = 101   ! No. of slices for the 3rd reciprocal vector
/

KCUBE_BULK
-0.50 -0.50 -0.50   ! Original point for 3D k plane
 1.00  0.00  0.00   ! The 1st vector to define 3d k cube
 0.00  1.00  0.00   ! The 2nd vector to define 3d k cube
 0.00  0.00  1.00   ! The 3rd vector to define 3d k cube
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a>, <span class="xref std std-ref">kcubebulk</span></p>
<p>The outputs for Gap_plane mode are <strong>GapCube.dat</strong>, <strong>GapCube.gnu</strong>. The <strong>GapCube.png</strong> will get by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">GapCube</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p>The head of <strong>GapCube.dat</strong> are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">kx</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">A</span><span class="p">)</span>        <span class="n">ky</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">A</span><span class="p">)</span>        <span class="n">kz</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">A</span><span class="p">)</span>      <span class="n">Energy</span> <span class="n">gap</span>              <span class="n">Ev</span>              <span class="n">Ec</span>      <span class="n">k1</span> <span class="p">(</span><span class="mi">2</span><span class="n">pi</span><span class="o">/</span><span class="n">a</span><span class="p">)</span>      <span class="n">k2</span> <span class="p">(</span><span class="mi">2</span><span class="n">pi</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>      <span class="n">k3</span> <span class="p">(</span><span class="mi">2</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
<span class="mf">0.00000000</span>      <span class="mf">0.87665487</span>     <span class="o">-</span><span class="mf">0.54846229</span>      <span class="mf">0.79075142</span>     <span class="o">-</span><span class="mf">0.34827281</span>      <span class="mf">0.44247861</span>     <span class="o">-</span><span class="mf">0.50000000</span>     <span class="o">-</span><span class="mf">0.50000000</span>     <span class="o">-</span><span class="mf">0.50000000</span>
<span class="mf">0.00000000</span>      <span class="mf">0.87665487</span>     <span class="o">-</span><span class="mf">0.51555455</span>      <span class="mf">0.86792416</span>     <span class="o">-</span><span class="mf">0.38635069</span>      <span class="mf">0.48157346</span>     <span class="o">-</span><span class="mf">0.50000000</span>     <span class="o">-</span><span class="mf">0.50000000</span>     <span class="o">-</span><span class="mf">0.45000000</span>
</pre></div>
</div>
<ul class="simple">
<li>Column 1-3 are the Cartesian coordinates of the k points where energy gap is small than Gap_threshold, in unit of <span class="math">\(\frac{1}{Angstrom}\)</span></li>
<li>Column 4 is the energy gap. Those values are smaller than Gap_threshold, see <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a></li>
<li>Column 5-6 are the energy value for valence and conduction bands close to the Fermi level. There are
4 conduction bands and 4 valence bands.</li>
<li>Column 7-9 are the Direct coordinates of the k points.</li>
</ul>
</div>
</div>
<div class="section" id="find-nodes-calculation">
<span id="findnodescalculation"></span><h2>1.3.5. Find Nodes calculation<a class="headerlink" href="#find-nodes-calculation" title="Permalink to this headline">¶</a></h2>
<p>Beside by using GapCube and GapPlane to find Weyl/Dirac nodes or node lines, we can directly
using FindNodes function.
<span class="math">\(gap(k)= E_{NumOccupied+1}(k)- E_{NumOccpuied}(k)\)</span></p>
<div class="section" id="id7">
<h3>Input<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Typical input parameters for FindNodes_cube calculation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
FindNodes_calc = T
/
&amp;PARAMETERS
Nk1 = 8   ! No. of slices for the 1st reciprocal vector
Nk2 = 8   ! No. of slices for the 2nd reciprocal vector
Nk3 = 8   ! No. of slices for the 3rd reciprocal vector
Gap_threshold = 0.0001 ! a value to determine which point should be identified as a node
/

KCUBE_BULK
-0.50 -0.50 -0.50   ! Original point for 3D k plane
 1.00  0.00  0.00   ! The 1st vector to define 3d k cube
 0.00  1.00  0.00   ! The 2nd vector to define 3d k cube
 0.00  0.00  1.00   ! The 3rd vector to define 3d k cube
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please don’t set Nk1, Nk2, Nk3 too large. Otherwise, it will become very time consuming. Usually, 15*15*15 is enough to get converged number of Weyl/Dirac points.</p>
</div>
</div>
<div class="section" id="id8">
<h3>Output<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>Nodes.dat</strong> and <strong>Nodes.gnu</strong>. Nodes.png will be obtained by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">Nodes</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p>Here are heads of output for WTe2 <strong>Nodes.dat</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># local minimal position and the related energy gap</span>
<span class="c1">#      kx          ky          kz         gap           E          k1          k2          k3</span>
    <span class="mf">0.219436</span>   <span class="o">-</span><span class="mf">0.045611</span>   <span class="o">-</span><span class="mf">0.000001</span>    <span class="mf">0.000000</span>    <span class="mf">0.056688</span>    <span class="mf">0.121432</span>   <span class="o">-</span><span class="mf">0.045363</span>   <span class="o">-</span><span class="mf">0.000003</span>
   <span class="o">-</span><span class="mf">0.219515</span>   <span class="o">-</span><span class="mf">0.045063</span>   <span class="o">-</span><span class="mf">0.000001</span>    <span class="mf">0.000000</span>    <span class="mf">0.056461</span>   <span class="o">-</span><span class="mf">0.121476</span>   <span class="o">-</span><span class="mf">0.044818</span>   <span class="o">-</span><span class="mf">0.000002</span>
    <span class="mf">0.220195</span>   <span class="o">-</span><span class="mf">0.038682</span>   <span class="o">-</span><span class="mf">0.000002</span>    <span class="mf">0.000000</span>    <span class="mf">0.051264</span>    <span class="mf">0.121852</span>   <span class="o">-</span><span class="mf">0.038472</span>   <span class="o">-</span><span class="mf">0.000003</span>
   <span class="o">-</span><span class="mf">0.220183</span>   <span class="o">-</span><span class="mf">0.038936</span>   <span class="o">-</span><span class="mf">0.000001</span>    <span class="mf">0.000000</span>    <span class="mf">0.051618</span>   <span class="o">-</span><span class="mf">0.121845</span>   <span class="o">-</span><span class="mf">0.038724</span>   <span class="o">-</span><span class="mf">0.000003</span>
    <span class="mf">0.219514</span>    <span class="mf">0.045063</span>    <span class="mf">0.000001</span>    <span class="mf">0.000000</span>    <span class="mf">0.056459</span>    <span class="mf">0.121475</span>    <span class="mf">0.044818</span>    <span class="mf">0.000003</span>
   <span class="o">-</span><span class="mf">0.219434</span>    <span class="mf">0.045620</span>    <span class="mf">0.000002</span>    <span class="mf">0.000000</span>    <span class="mf">0.056692</span>   <span class="o">-</span><span class="mf">0.121431</span>    <span class="mf">0.045371</span>    <span class="mf">0.000004</span>
   <span class="o">-</span><span class="mf">0.220194</span>    <span class="mf">0.038678</span>    <span class="mf">0.000000</span>    <span class="mf">0.000000</span>    <span class="mf">0.051259</span>   <span class="o">-</span><span class="mf">0.121851</span>    <span class="mf">0.038468</span>    <span class="mf">0.000001</span>
    <span class="mf">0.220181</span>    <span class="mf">0.038941</span>    <span class="mf">0.000000</span>    <span class="mf">0.000000</span>    <span class="mf">0.051620</span>    <span class="mf">0.121844</span>    <span class="mf">0.038729</span>    <span class="mf">0.000001</span>
</pre></div>
</div>
<p>You will find that there are 8 Weyl points in the BZ as expected.</p>
</div>
</div>
<div class="section" id="weyl-chirality-calculation">
<span id="weylchiralitycalculation"></span><h2>1.3.6. Weyl Chirality calculation<a class="headerlink" href="#weyl-chirality-calculation" title="Permalink to this headline">¶</a></h2>
<p>After you identify the positions of Weyl points, you could use this function to calculate the chirality,
which tells you whether a Weyl point is a sink or a source of the Berry Curvature.</p>
<div class="section" id="id9">
<h3>Input<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Typical input parameters for WeylChirality_calc calculation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
WeylChirality_calc = T
/
&amp;PARAMETERS
Nk1 = 41   ! No. of slices for the 1st reciprocal vector, berry phase integration direction
Nk2 = 21   ! No. of slices for the 2nd reciprocal vector
/

WEYL_CHIRALITY
8            ! Num_Weyls
Cartesian    ! Direct or Cartesian coordinate
0.004        ! Radius of the ball surround a Weyl point
 0.219436   -0.045611   -0.000000    ! Positions of Weyl points, No. of lines should larger than Num_weyls
-0.219515   -0.045063   -0.000000
 0.220195   -0.038682   -0.000000
-0.220183   -0.038936   -0.000000
 0.219514    0.045063    0.000000
-0.219434    0.045620    0.000000
-0.220194    0.038678    0.000000
 0.220181    0.038941    0.000000
</pre></div>
</div>
<p>Outputs are <strong>wanniercenter3D_Weyl.dat</strong> and <strong>wanniercenter3D_Weyl_i.gnu</strong>. wanniercenter3D_Weyl.png will be obtained by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>gnuplot wanniercenter3D_Weyl_i.gnu

for ((i=1; i&lt;9; i++)); do gnuplot wanniercenter3D_Weyl_$i.gnu;done
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">i is an integer from 1 to Num_weyls</p>
</div>
<p>Here are heads of output for WTe2 <strong>wanniercenter3D_Weyl.dat</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Chirality              -1               1               1              -1               1              -1               1              -1</span>
       <span class="c1"># k            phase           phase           phase           phase           phase           phase           phase           phase</span>
 <span class="mf">0.00000000</span>      <span class="mf">0.99970932</span>      <span class="mf">0.00005854</span>      <span class="mf">0.00004671</span>      <span class="mf">0.99975139</span>      <span class="mf">0.00005851</span>      <span class="mf">0.99970861</span>      <span class="mf">0.00004736</span>      <span class="mf">0.99975087</span>
 <span class="mf">0.05000000</span>      <span class="mf">0.89229069</span>      <span class="mf">0.08696587</span>      <span class="mf">0.08941971</span>      <span class="mf">0.90855415</span>      <span class="mf">0.08723118</span>      <span class="mf">0.89170870</span>      <span class="mf">0.09022452</span>      <span class="mf">0.90795187</span>
 <span class="mf">0.10000000</span>      <span class="mf">0.79659821</span>      <span class="mf">0.16589558</span>      <span class="mf">0.17112299</span>      <span class="mf">0.82248889</span>      <span class="mf">0.16697194</span>      <span class="mf">0.79511289</span>      <span class="mf">0.17279423</span>      <span class="mf">0.82108022</span>
</pre></div>
</div>
<p>The first line shows the chiralities of each Weyl point. The first column is k point. From the 2nd to the last column
show the Wannier charge center phase. In total, there are Num_weyls columns.</p>
</div>
</div>
<div class="section" id="slab-band-calculation">
<span id="slabbandcalculation"></span><h2>1.3.7. Slab band calculation<a class="headerlink" href="#slab-band-calculation" title="Permalink to this headline">¶</a></h2>
<p>Before using iterative green’s function to get the surface state spectrum for semi-infinite system.
We also can just construct a finite thickness slab system and
calculate the band structure for it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For slab calculations, please read carefully the input card <a class="reference internal" href="input.html#surface"><span class="std std-ref">SURFACE</span></a></p>
</div>
<div class="section" id="id10">
<h3>Input<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
SlabBand_calc = T
/
&amp;SYSTEM
NSLAB = 10
/
&amp;PARAMETERS
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
/
KPATH_SLAB
2        ! numker of k line for 2D case
K 0.33 0.67 G 0.0 0.0  ! k path for 2D case
G 0.0 0.0 M 0.5 0.5
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#systemnamelist"><span class="std std-ref">SYSTEM</span></a> <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a>, <a class="reference internal" href="input.html#kpathslab"><span class="std std-ref">KPATH_SLAB</span></a></p>
</div>
<div class="section" id="id11">
<h3>Output<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>slabek.dat</strong> and <strong>slabek.gnu</strong></p>
<p>The heads of <strong>slabek.dat</strong> are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">0.0000000</span>     <span class="o">-</span><span class="mf">4.9575466</span>     <span class="mi">240</span>
<span class="mf">0.0508687</span>     <span class="o">-</span><span class="mf">5.0110528</span>     <span class="mi">226</span>
<span class="mf">0.1017373</span>     <span class="o">-</span><span class="mf">5.0566963</span>     <span class="mi">221</span>
<span class="mf">0.1526060</span>     <span class="o">-</span><span class="mf">5.0671994</span>     <span class="mi">220</span>
<span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li>The 1st column are k points in the KPATH_SLAB</li>
<li>The 2nd column are energy values.</li>
<li>The 3rd column represent the surface weight, which is normalized to 255.</li>
</ul>
<p>The colorfull plot <strong>slabek.png</strong> of the slab energy bands can be obtained by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">slabek</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="nanowire-nanoribbon-band-calculation">
<span id="ribbonbandcalculation"></span><h2>1.3.8. Nanowire/nanoribbon  band calculation<a class="headerlink" href="#nanowire-nanoribbon-band-calculation" title="Permalink to this headline">¶</a></h2>
<p>Band calculation for wire system. Only one direction is periodic, the other two directions are confined.</p>
<div class="section" id="id12">
<h3>Input<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>You don’t have to set the k path, because it only has one direction.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
WireBand_calc = T
/
&amp;SYSTEM
NSLAB1 = 4
NSLAB2 = 4
/
&amp;PARAMETERS
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
/
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#systemnamelist"><span class="std std-ref">SYSTEM</span></a> <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a></p>
</div>
<div class="section" id="id13">
<h3>Output<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>ribbonek.dat</strong> and <strong>ribbonek.gnu</strong>. The data format of <strong>ribbonek.dat</strong> is the same as
<strong>slabek.dat</strong>. Get plot ribbonek.png with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">ribbonek</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="surface-state-arpes-calculation">
<span id="sscalculation"></span><h2>1.3.9. Surface state ARPES calculation<a class="headerlink" href="#surface-state-arpes-calculation" title="Permalink to this headline">¶</a></h2>
<p>One important feature for topological materials is the surface state. The bulk-edge correspondence
tells us, if the topological property of the bulk system is nontrivial, then there will be
nontrivial states on the surface. Nowadays, there are several method to detect the surface states.
One direct way is the angle resolved photoemission spectroscopy (ARPES). Such spectrum can be
obtained by the iterative Green’s function.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For slab calculations, please read carefully the input card <a class="reference internal" href="input.html#surface"><span class="std std-ref">SURFACE</span></a></p>
</div>
<div class="section" id="id14">
<h3>Input<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
SlabSS_calc = T
/
&amp;PARAMETERS
OmegaNum = 101
OmegaMin = -1.0
OmegaMax =  1.0
Nk1 = 101   ! No. of slices for the 1st reciprocal vector
NP = 2      ! principle layer
/
KPATH_SLAB
2        ! numker of k line for 2D case
K 0.33 0.67 G 0.0 0.0  ! k path for 2D case
G 0.0 0.0 M 0.5 0.5
</pre></div>
</div>
<p>See <a class="reference internal" href="input.html#controlnamelist"><span class="std std-ref">CONTROL</span></a>, <a class="reference internal" href="input.html#parametersnamelist"><span class="std std-ref">PARAMETERS</span></a>, <a class="reference internal" href="input.html#kpathslab"><span class="std std-ref">KPATH_SLAB</span></a></p>
<p>NP : integer valued, Number of principle layers, see details related to iterative green’s function.
Used if  SlabSS_calc= T, SlabArc_calc=T, SlabSpintexture_calc=T. Default value is 2. You need to do a convergence test by setting Np= 1, Np=2, Np=3, and check the surface state spectrum. Basically, the value of Np depends on the spread of Wannier functions you constructed. One thing should be mentioned is that the computational time grows cubically of Np.</p>
</div>
<div class="section" id="id15">
<h3>Output<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>The output files are <strong>surfdos_l.dat</strong>, <strong>surfdos_r.dat</strong>, <strong>surfdos_l.gnu</strong>, <strong>surfdos_r.gnu</strong>. You could get the the spectral function
plots with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">surfdos_l</span><span class="o">.</span><span class="n">gnu</span>
<span class="n">gnuplot</span> <span class="n">surfdos_r</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<p><strong>_l</strong> and <strong>_r</strong> means the top and bottom surface.</p>
</div>
</div>
<div class="section" id="surface-state-qpi-calculation">
<span id="ssqpicalculation"></span><h2>1.3.10. Surface state QPI calculation<a class="headerlink" href="#surface-state-qpi-calculation" title="Permalink to this headline">¶</a></h2>
<p>Settings for this feature are almost the same as <a class="reference internal" href="#fermiarccalculation"><span class="std std-ref">Fermi arc calculation</span></a>. Only difference is that
you should set</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">CONTROL</span>
<span class="n">SlabQPI_calc</span>          <span class="o">=</span> <span class="n">T</span>
<span class="o">/</span>
</pre></div>
</div>
<div class="section" id="id16">
<h3>Output<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>There are a lot of outputs for QPI calculation. including</dt>
<dd><p class="first">arc.dat_l, arc.dat_r,
arc_l.gnu, arc_r.gnu,
arc_l_only.gnu, arc_l_only.gnu,
arc.jdat_l, arc.jdat_r,
arc.jsdat_l, arc.jsdat_r,
arc_l_jdos.gnu, arc_l_jsdos.gnu,
arc_r_jdos.gnu, arc_r_jsdos.gnu.</p>
<p class="last">The gnu script with ‘only’ means we only plot the spectrum with the surface contribution, exclude the
bulk contribution.  jdat_l is the QPI data without consideration of spin scattering. jsdat_l is the QPI data in consideration of spin scattering.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="fermi-arc-calculation">
<span id="fermiarccalculation"></span><h2>1.3.11. Fermi arc calculation<a class="headerlink" href="#fermi-arc-calculation" title="Permalink to this headline">¶</a></h2>
<p>Surface state spectrum at fixed energy level E_arc set in NAMELISTS PARAMETERS . Set SlabArc_calc=T,
and  set Nk1, Nk2, in NAMELISTS PARAMETERS, set k plane in KPLANE_SLAB CARD.
Get the plots with  “gnuplot arc_l.gnu”, “gnuplot arc_r.gnu”. <strong>_l</strong> and <strong>_r</strong> means the top and bottom surface.</p>
</div>
<div class="section" id="spin-texture-calculation">
<span id="spintexturecalculation"></span><h2>1.3.12. Spin texture calculation<a class="headerlink" href="#spin-texture-calculation" title="Permalink to this headline">¶</a></h2>
<p>Spin texture calculation at fixed energy level E_arc set in NAMELISTS PARAMETERS .
Set Slabspintexture_calc=T, and  set Nk1, Nk2, in NAMELISTS PARAMETERS, set k plane in KPLANE_SLAB CARD.
Get the plots with  “gnuplot spintext_l.gnu”, “gnuplot spintext_r.gnu”.</p>
</div>
<div class="section" id="berry-phase-calculation">
<span id="berryphasecalculation"></span><h2>1.3.13. Berry phase calculation<a class="headerlink" href="#berry-phase-calculation" title="Permalink to this headline">¶</a></h2>
<p>Calculate Berry phase of a closed k path in 3D BZ. This is useful in a nodal line system. It is demonstrated that
the Berry phase around a closed mirror symmetric k loop is either 0 or pi for a mirror protect nodal line system.</p>
<p>In WannierTools, you can specify a k path by a serials  k points. Here we take the WC example, which has two nodal lines around
K point.</p>
<div class="section" id="id17">
<h3>Input<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
BerryPhase_calc = T
/
&amp;SYSTEM
NumOccupied = 10        ! Number of occupied Wannier orbitals
/
&amp;PARAMETERS
Nk1 = 21    ! No. of slices for the 1st reciprocal vector
/

KPATH_BERRY
11
Direct
 0.3    0.333  -0.2
 0.3    0.333  -0.1
 0.3    0.333  -0.0
 0.3    0.333   0.1
 0.3    0.333   0.2
 0.33   0.333   0.2
 0.33   0.333   0.1
 0.33   0.333   0.0
 0.33   0.333  -0.1
 0.33   0.333  -0.2
 0.3    0.333  -0.2
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h3>Output<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>The value of Berry phase can be found in the <strong>WT.out</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>1. In principlely, the Berry phase for around a nodal line should be interger. However,
the MLWF-TB model usally is not symmetric. So the value of Berry phase is close to zero
or one.</p>
<ol class="last arabic simple" start="2">
<li>The first and the last kpoints in the KPATH_BERRY should be the same to form a loop.</li>
</ol>
</div>
</div>
</div>
<div class="section" id="berry-curvature-calculation">
<span id="berrycurvcalculation"></span><h2>1.3.14. Berry curvature calculation<a class="headerlink" href="#berry-curvature-calculation" title="Permalink to this headline">¶</a></h2>
<p>Calculate Berry curvature at a fixed k plane in 3D BZ. Set BerryCurvature_calc=T, and  set Nk1, Nk2, in NAMELISTS PARAMETERS, set k plane in KPLANE_BULK CARD. Get the plot with  “gnuplot Berrycurvature.gnu”.</p>
<p>please set NumOccpuied correctly. It represents the “occpuied” wannier bands, not the total number of electrons. In this application, the Berrycurvature is the summation over NumOccupied bands.</p>
</div>
<div class="section" id="wannier-charge-center-wilson-loop-calculation">
<span id="wanniercentercalculation"></span><h2>1.3.15. Wannier charge center/Wilson loop calculation<a class="headerlink" href="#wannier-charge-center-wilson-loop-calculation" title="Permalink to this headline">¶</a></h2>
<p>Wannier charge center, which is sometimes called Wilson loop can be calculated by set WannierCenter_calc=T and set KPLANE_BULK CARD,  set number of k points for two vectors is Nk1, Nk2 in NAMELISTS PARAMETERS.  Notice: You should notice that the first vector in KPLANE_BULK CARD is the integration direction, this vector should be equal to one primitive reciprocal lattice vector.  If you want to calculate the Z2 number, Please set the second vector to be half of the reciprocal lattice vector. You can get the Wannier charge center  along the second k line. See more details In the paper written by Alexey. Soluyanov (2011).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Important: please set <strong>NumOccpuied</strong> correctly. It represents the “occpuied” wannier bands, not the total number of electrons.
In this application, the Wilson loop is the trace of NumOccupied bands. If you want to study the topology between the 8th and the 9th band,
then set NumOccupied=8.</p>
</div>
<div class="section" id="id19">
<h3>Output<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>wcc.dat</strong> and <strong>wcc.gnu</strong>, the format of <strong>wcc.dat</strong> is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#         k      largestgap  sum(wcc(:,ik))      wcc(i, ik)(i=1, NumOccupied)</span>
 <span class="mf">0.00000000</span>      <span class="mf">0.60940556</span>      <span class="mf">0.99998388</span>      <span class="mf">0.00000850</span>      <span class="mf">0.07701431</span>      <span class="mf">0.07702018</span>      <span class="mf">0.19328973</span>      <span class="mf">0.19329593</span>      <span class="mf">0.28118760</span>      <span class="mf">0.28119336</span>      <span class="mf">0.49998615</span>      <span class="mf">0.50000060</span>      <span class="mf">0.71881052</span>      <span class="mf">0.71881646</span>      <span class="mf">0.80675987</span>      <span class="mf">0.80676424</span>      <span class="mf">0.92297767</span>      <span class="mf">0.92298328</span>      <span class="mf">0.99993530</span>      <span class="mf">0.99994085</span>      <span class="mf">0.99999935</span>
 <span class="mf">0.00312500</span>      <span class="mf">0.61256609</span>      <span class="mf">0.99998716</span>      <span class="mf">0.00030351</span>      <span class="mf">0.00082300</span>      <span class="mf">0.07688154</span>      <span class="mf">0.07709302</span>      <span class="mf">0.19117885</span>      <span class="mf">0.19525313</span>      <span class="mf">0.27952027</span>      <span class="mf">0.28297172</span>      <span class="mf">0.49188658</span>      <span class="mf">0.50810192</span>      <span class="mf">0.71703027</span>      <span class="mf">0.72048573</span>      <span class="mf">0.80480135</span>      <span class="mf">0.80887751</span>      <span class="mf">0.92290159</span>      <span class="mf">0.92311931</span>      <span class="mf">0.99908212</span>      <span class="mf">0.99967575</span>
 <span class="mf">0.00625000</span>      <span class="mf">0.61569946</span>      <span class="mf">0.99999557</span>      <span class="mf">0.00061525</span>      <span class="mf">0.00168708</span>      <span class="mf">0.07668131</span>      <span class="mf">0.07711296</span>      <span class="mf">0.18887026</span>      <span class="mf">0.19709893</span>      <span class="mf">0.27796336</span>      <span class="mf">0.28485788</span>      <span class="mf">0.48373617</span>      <span class="mf">0.51625672</span>      <span class="mf">0.71514220</span>      <span class="mf">0.72204447</span>      <span class="mf">0.80295562</span>      <span class="mf">0.81118878</span>      <span class="mf">0.92287871</span>      <span class="mf">0.92332259</span>      <span class="mf">0.99821913</span>      <span class="mf">0.99936414</span>

 <span class="o">......</span>
</pre></div>
</div>
<p>The second column is the position of the largest gap of WCC. It is used for drawing a line to calculate the Z2 number (see A. Soluyanov 2011),
From the fourth column to the last column, they are wcc for the occupied bands specified with “NumOccupied”.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Take Bi2Se3 for example, we calculate the Wilson loop (WCC) at k3=0 plane, where k1, k2, k3 is in unit
of reciprocal lattice vector.  The you should set the particular inputs like this</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
 WannierCenter_calc=T
/
&amp;SYSTEM
NumOccupied = 10        ! Number of occupied Wannier orbitals
/
&amp;PARAMETERS
Nk1 = 41    ! No. of slices for the 1st reciprocal vector
Nk2 = 41    ! No. of slices for the 2st reciprocal vector
/

KPLANE_BULK
0.00  0.00  0.00   ! Original point for 3D k slice  k3=0
1.00  0.00  0.00   ! The first vector. Integrate along this direction to get WCC
0.00  0.50  0.00   ! WCC along this direction, for Z2, usually half of the reciprocal lattice vector
</pre></div>
</div>
<p>For 2D materials stacked along z direction, you could think it as a 3D material with
weak coupling along z direction. You can use this function to get the Z2 value at k3=0
plane to characterize the topology.</p>
<p>Use “gnuplot wcc.gnu” to get “wcc.eps” plot.</p>
<p>Here is an example.</p>
<a class="reference internal image-reference" href="images/WannierTools_WCC_plane.png"><img alt="images/WannierTools_WCC_plane.png" src="images/WannierTools_WCC_plane.png" style="width: 1152.0px; height: 648.0px;" /></a>
</div>
</div>
<div class="section" id="z2-number-for-3d-bulk-materials">
<span id="z2bulkcalculation"></span><h2>1.3.16. Z2 number for 3D bulk materials<a class="headerlink" href="#z2-number-for-3d-bulk-materials" title="Permalink to this headline">¶</a></h2>
<p>We can get Z2 topological index (v0, v1v2v3) from the z2 calculations of six time reversal invariant planes, i.e. (a) k1=0.0; (b) k1=0.5; (c) k2=0.0; (d) k2=0.5; (e) k3=0.0; (f) k3=0.5;
Usually, you can call “Wannier charge center calculation for a plane” six times. Here we packed them up to get another function. You can set the input file like the following.</p>
<div class="section" id="id20">
<h3>Input<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p>The necessary tags that you should set in the wt.in</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
Z2_3D_calc = T
/
&amp;PARAMETERS
NumOccpuied = 18  ! No. of occupied wannier bands
Nk1 = 41    ! No. of slices of the k points for WCCs
Nk2 = 41    ! No. of slices of the k points for WCCs
/
</pre></div>
</div>
</div>
<div class="section" id="id21">
<h3>Output<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>wanniercenter3D_Z2_1.dat, wanniercenter3D_Z2_2.dat, wanniercenter3D_Z2_3.dat, wanniercenter3D_Z2_4.dat, wanniercenter3D_Z2_5.dat, wanniercenter3D_Z2_6.dat</strong>
and <strong>wanniercenter3D_Z2.gnu</strong>. The z2 value can be found in the WT.out by searching “z2 number for 6 planes”.
The WCC (Wilson loop) plots <strong>wanniercenter3D_Z2.eps</strong> can be got with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">wanniercenter3D_Z2</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Important: please set <strong>NumOccpuied</strong> correctly. It represents the “occpuied” wannier bands, not the total number of electrons.
In this application, the Wilson loop is the trace of NumOccupied bands. If you want to study the topology between the 8th and the 9th band,
then set NumOccupied=8.</p>
<p>About the Z2 index for 3D system.</p>
<p>v0= (z2(ki=0)+z2(ki=0.5))mod 2</p>
<p class="last">vi= z2(ki=0.5)</p>
</div>
<p>For the 2D system, if you set the Z axis as the stack axis, please only take the Z2 number at k3=0 plane.</p>
</div>
</div>
<div class="section" id="chern-number-for-3d-bulk-materials">
<span id="chernbulkcalculation"></span><h2>1.3.17. Chern number for 3D bulk materials<a class="headerlink" href="#chern-number-for-3d-bulk-materials" title="Permalink to this headline">¶</a></h2>
<p>We can get Chern number of six k planes, i.e. k1=0.0; k1=0.5; k2=0.0; k2=0.5; k3=0.0; k3=0.5; where k1, k2, k3 is in fractional units.
Usually, you can call “Wannier charge center calculation for a plane”  six times. Here we packed them up to get another function. You can set the input file like the following.</p>
<p>Basically, the method used here is very similar to the one used in the Z2 number calculations. We also use the Wilson loop method. However, for Z2 calculation,
you only take half of the size of a time reversal invariant slice. For Chern number calculation, you need a closed momentum surface. For example, for the k1=0.0 plane,
half of the time reversal invariant slice would be defined like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">k2</span> <span class="ow">is</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">k3</span> <span class="ow">is</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>The full closed momentum surface would defined like this</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">k2</span> <span class="ow">is</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">k3</span> <span class="ow">is</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="id22">
<h3>Input<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>The necessary tags that you should set in the wt.in</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;CONTROL
Chern_3D_calc = T
/
&amp;PARAMETERS
NumOccpuied = 18  ! No. of occupied wannier bands
Nk1 = 41    ! No. of slices of the k points for WCCs
Nk2 = 41    ! No. of slices of the k points for WCCs
/
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h3>Output<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<p>Outputs are <strong>wanniercenter3D_Chern.dat</strong>
and <strong>wanniercenter3D_Chern.gnu</strong>. The Chern number can be found in the WT.out by searching “Chern number for 6 planes”.
The WCC (Wilson loop) plots <strong>wanniercenter3D_Chern.eps</strong> can be got with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnuplot</span> <span class="n">wanniercenter3D_Chern</span><span class="o">.</span><span class="n">gnu</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Important: please set <strong>NumOccpuied</strong> correctly. It represents the “occpuied” wannier bands, not the total number of electrons.
In this application, the Wilson loop is the trace of NumOccupied bands. If you want to study the topology between the 8th and the 9th band,
then set NumOccupied=8.</p>
</div>
<p>For the 2D system, if you set the Z axis as the stack axis, please only take the Chern number at k3=0 plane.</p>
</div>
</div>
<div class="section" id="landau-level-calculations">
<span id="landaulevel"></span><h2>1.3.18. Landau level calculations<a class="headerlink" href="#landau-level-calculations" title="Permalink to this headline">¶</a></h2>
<p><strong>This functionality is under testing, not released yet. Developed by QSWu and YFGuan</strong></p>
<p>By applying the uniform magnetic field along one lattice vector, the Landau level spectrum can be calculated by the Peierls substitution.</p>
<p>Here we put one example of Graphene. The input file wt.in is like this</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&amp;TB_FILE
Hrfile = &#39;wannier90_hr.dat&#39;
/

!&gt; bulk band structure calculation flag
&amp;CONTROL
BulkBand_calc                 = T
Hof_Butt_calc                 = T
LandauLevel_k_calc            = T
LandauLevel_wavefunction_calc = F
/

&amp;SYSTEM
NSLAB = 200             ! the size of magnetic supercell
NumOccupied = 1         ! NumOccupied
SOC = 0                 ! soc
E_FERMI = -1.2533       ! e-fermi
/

&amp;PARAMETERS
E_arc = 0.00        ! energy for calculate Fermi Arc
OmegaNum = 201      ! number of eigenvalues to calculate the Landau levels
Nk1 = 100           ! number k points for each line in the kpath_bulk
/

LATTICE
Angstrom
2.1377110  -1.2342080   0.0000000
0.0000000   2.4684160   0.0000000
0.0000000   0.0000000   10.000000

!&gt; used when you want to study the projections on the orbital for each band
SELECTEDORBITALS
1  ! NumberofSelectedOrbitals without spin degeneracy
1  ! SelectedOrbitals indices without spin degeneracy

ATOM_POSITIONS
2                               ! number of atoms for projectors
Direct                          ! Direct or Cartisen coordinate
C 0.333333 0.666667 0.500000 C
C 0.666667 0.333333 0.500000 C

PROJECTORS
1 1        ! number of projectors
C  pz
C  pz

SURFACE
 0  0  1     ! magnetic field direction in units of lattice vectors
 1  0  0

KPATH_BULK            ! k point path
1              ! number of k line only for bulk band
M   0.50000  0.00000  0.00000   G   0.00000  0.00000  0.00000

WANNIER_CENTRES
Cartesian
0.712570  1.234209  5.000000
1.425141 -0.000001  5.000000
</pre></div>
</div>
<p>We can calculate the Hofstader butterfly plot by setting  <strong>Hof_Butt_calc  = T</strong>. <strong>Nslab</strong> is the size of the supercell. The corresponding
magnetic field strength can be found in the output WT.out.</p>
<p>Since the calculation for magnetic supercell is very heavy, we have two versions of eigenvalue solvers. One is direct
diagonalization, the other one is the ARPACK solver, which is based on the sparse matrix. So you have to install the ARPACK package, and specify the
library in the Makefile. You don’t have to choose the solvers. It is automatically chosen according to the matrix
dimensionality. If the dimensionality of the Hamiltonian matrix of the magnetic supercell is larger than 1600, WannierTools
will call the sparse matrix solver.</p>
<p>Once the sparse matrix solver is chosen. You have to set <strong>E_arc</strong> and <strong>OmegaNum</strong>, which means you are going to calculate
2*OmegaNum+1 Landau energy levels around <strong>E_arc</strong> respect to the Fermi level.</p>
<p>The magnetic field is along the first vector specified in the SURFACE card.</p>
<a class="reference internal image-reference" href="images/WannierTools-landaulevel.png"><img alt="images/WannierTools-landaulevel.png" src="images/WannierTools-landaulevel.png" style="width: 1152.0px; height: 648.0px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.3. Capabilities of WannierTools</a><ul>
<li><a class="reference internal" href="#bulk-band-calculation-line-mode-and-plane-mode">1.3.1. Bulk band calculation (line mode and plane mode)</a><ul>
<li><a class="reference internal" href="#line-mode">Line mode</a><ul>
<li><a class="reference internal" href="#input">Input</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plane-mode">Plane mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bulkfs-calculation">1.3.2. BulkFS calculation</a><ul>
<li><a class="reference internal" href="#id3">Input</a></li>
<li><a class="reference internal" href="#id4">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#density-state-dos-calculations">1.3.3. Density state(DOS) calculations</a></li>
<li><a class="reference internal" href="#energy-gap-calculations-plane-and-cube-mode">1.3.4. Energy gap calculations (plane and cube mode)</a><ul>
<li><a class="reference internal" href="#gap-plane-mode">Gap_plane mode</a><ul>
<li><a class="reference internal" href="#id5">Input</a></li>
<li><a class="reference internal" href="#id6">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gap-cube-mode">Gap_Cube mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#find-nodes-calculation">1.3.5. Find Nodes calculation</a><ul>
<li><a class="reference internal" href="#id7">Input</a></li>
<li><a class="reference internal" href="#id8">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weyl-chirality-calculation">1.3.6. Weyl Chirality calculation</a><ul>
<li><a class="reference internal" href="#id9">Input</a></li>
</ul>
</li>
<li><a class="reference internal" href="#slab-band-calculation">1.3.7. Slab band calculation</a><ul>
<li><a class="reference internal" href="#id10">Input</a></li>
<li><a class="reference internal" href="#id11">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nanowire-nanoribbon-band-calculation">1.3.8. Nanowire/nanoribbon  band calculation</a><ul>
<li><a class="reference internal" href="#id12">Input</a></li>
<li><a class="reference internal" href="#id13">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-state-arpes-calculation">1.3.9. Surface state ARPES calculation</a><ul>
<li><a class="reference internal" href="#id14">Input</a></li>
<li><a class="reference internal" href="#id15">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-state-qpi-calculation">1.3.10. Surface state QPI calculation</a><ul>
<li><a class="reference internal" href="#id16">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fermi-arc-calculation">1.3.11. Fermi arc calculation</a></li>
<li><a class="reference internal" href="#spin-texture-calculation">1.3.12. Spin texture calculation</a></li>
<li><a class="reference internal" href="#berry-phase-calculation">1.3.13. Berry phase calculation</a><ul>
<li><a class="reference internal" href="#id17">Input</a></li>
<li><a class="reference internal" href="#id18">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#berry-curvature-calculation">1.3.14. Berry curvature calculation</a></li>
<li><a class="reference internal" href="#wannier-charge-center-wilson-loop-calculation">1.3.15. Wannier charge center/Wilson loop calculation</a><ul>
<li><a class="reference internal" href="#id19">Output</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#z2-number-for-3d-bulk-materials">1.3.16. Z2 number for 3D bulk materials</a><ul>
<li><a class="reference internal" href="#id20">Input</a></li>
<li><a class="reference internal" href="#id21">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chern-number-for-3d-bulk-materials">1.3.17. Chern number for 3D bulk materials</a><ul>
<li><a class="reference internal" href="#id22">Input</a></li>
<li><a class="reference internal" href="#id23">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#landau-level-calculations">1.3.18. Landau level calculations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="input.html"
                        title="previous chapter">1.2. Introduction of input files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorials.html"
                        title="next chapter">2. Tutorial: learning WannierTools through examples</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorials.html" title="2. Tutorial: learning WannierTools through examples"
             >next</a></li>
        <li class="right" >
          <a href="input.html" title="1.2. Introduction of input files"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">WannierTools 2.2.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="preliminaries.html" >1. Preliminaries</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, QuanSheng Wu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7+.
    </div>
  </body>
</html>